from datetime import timedelta
from os import environ

class Configuration:
    #127.0.0.1
    #CHECK ENVIRONMENT VARIABLES
    if "DOCKER_INSTANCE" in environ:
        DATABASE_URL = "database_store"
        SPARK_APP_URL = "spark-app"
        WEB3_PROVIDER_URI = "http://ganache-cli:8545"
    else:
        WEB3_PROVIDER_URI = "http://127.0.0.1:8545"
        DATABASE_URL = "127.0.0.1"
        SPARK_APP_URL = "127.0.0.1"
    if "SPARK_INSTANCE" in environ:
        SPARK_URL = "spark-master"
    else:
        SPARK_URL = "127.0.0.1"

    SQLALCHEMY_DATABASE_URI   = f"mysql://root:root@{DATABASE_URL}:3306/store"
    SPARK_MASTER_URI          = f"spark://{SPARK_URL}:7077"
    JWT_SECRET_KEY            = "JWT_SECRET_DEV_KEY"
    OWNER_PRIVATE_KEY         = "0xb64be88dd6b89facf295f4fd0dda082efcbe95a2bb4478f5ee582b7efe88cf60"
    CONTRACT_ABI              = [
                    {
                        "inputs": [
                            {
                                "internalType": "address",
                                "name": "_buyer",
                                "type": "address"
                            },
                            {
                                "internalType": "uint256",
                                "name": "_cost",
                                "type": "uint256"
                            }
                        ],
                        "stateMutability": "nonpayable",
                        "type": "constructor"
                    },
                    {
                        "inputs": [],
                        "name": "buyer",
                        "outputs": [
                            {
                                "internalType": "address",
                                "name": "",
                                "type": "address"
                            }
                        ],
                        "stateMutability": "view",
                        "type": "function"
                    },
                    {
                        "inputs": [],
                        "name": "cost",
                        "outputs": [
                            {
                                "internalType": "uint256",
                                "name": "",
                                "type": "uint256"
                            }
                        ],
                        "stateMutability": "view",
                        "type": "function"
                    },
                    {
                        "inputs": [],
                        "name": "courier",
                        "outputs": [
                            {
                                "internalType": "address",
                                "name": "",
                                "type": "address"
                            }
                        ],
                        "stateMutability": "view",
                        "type": "function"
                    },
                    {
                        "inputs": [],
                        "name": "delivered",
                        "outputs": [],
                        "stateMutability": "nonpayable",
                        "type": "function"
                    },
                    {
                        "inputs": [],
                        "name": "owner",
                        "outputs": [
                            {
                                "internalType": "address",
                                "name": "",
                                "type": "address"
                            }
                        ],
                        "stateMutability": "view",
                        "type": "function"
                    },
                    {
                        "inputs": [],
                        "name": "pay",
                        "outputs": [],
                        "stateMutability": "payable",
                        "type": "function"
                    },
                    {
                        "inputs": [
                            {
                                "internalType": "address",
                                "name": "_courier",
                                "type": "address"
                            }
                        ],
                        "name": "pickUpPackage",
                        "outputs": [],
                        "stateMutability": "nonpayable",
                        "type": "function"
                    },
                    {
                        "inputs": [],
                        "name": "state",
                        "outputs": [
                            {
                                "internalType": "enum Order.State",
                                "name": "",
                                "type": "uint8"
                            }
                        ],
                        "stateMutability": "view",
                        "type": "function"
                    }
                ]
    CONTRACT_BYTECODE        = "60806040523480156200001157600080fd5b5060405162000f8838038062000f8883398181016040528101906200003791906200019a565b336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555081600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550806003819055506000600460006101000a81548160ff02191690836003811115620000e857620000e7620001e1565b5b0217905550505062000210565b600080fd5b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b60006200012782620000fa565b9050919050565b62000139816200011a565b81146200014557600080fd5b50565b60008151905062000159816200012e565b92915050565b6000819050919050565b62000174816200015f565b81146200018057600080fd5b50565b600081519050620001948162000169565b92915050565b60008060408385031215620001b457620001b3620000f5565b5b6000620001c48582860162000148565b9250506020620001d78582860162000183565b9150509250929050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602160045260246000fd5b610d6880620002206000396000f3fe60806040526004361061007b5760003560e01c80638da5cb5b1161004e5780638da5cb5b1461010b578063bbdfbfba14610136578063c19d93fb1461014d578063e32c0e5f146101785761007b565b806313faede6146100805780631b9265b8146100ab57806350a7f7d3146100b55780637150d8ae146100e0575b600080fd5b34801561008c57600080fd5b506100956101a1565b6040516100a2919061076f565b60405180910390f35b6100b36101a7565b005b3480156100c157600080fd5b506100ca61031e565b6040516100d791906107cb565b60405180910390f35b3480156100ec57600080fd5b506100f5610344565b60405161010291906107cb565b60405180910390f35b34801561011757600080fd5b5061012061036a565b60405161012d91906107cb565b60405180910390f35b34801561014257600080fd5b5061014b61038e565b005b34801561015957600080fd5b506101626105d0565b60405161016f919061085d565b60405180910390f35b34801561018457600080fd5b5061019f600480360381019061019a91906108a9565b6105e3565b005b60035481565b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614610237576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161022e90610959565b60405180910390fd5b6000600381111561024b5761024a6107e6565b5b600460009054906101000a900460ff16600381111561026d5761026c6107e6565b5b146102ad576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016102a4906109c5565b60405180910390fd5b60035434146102f1576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016102e890610a57565b60405180910390fd5b6001600460006101000a81548160ff02191690836003811115610317576103166107e6565b5b0217905550565b600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b60008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161461041e576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161041590610959565b60405180910390fd5b60026003811115610432576104316107e6565b5b600460009054906101000a900460ff166003811115610454576104536107e6565b5b14610494576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161048b90610ae9565b60405180910390fd5b6003808111156104a7576104a66107e6565b5b600460009054906101000a900460ff1660038111156104c9576104c86107e6565b5b50506000600560016003546104de9190610b38565b6104e89190610ba9565b90506000816003546104fa9190610bda565b9050600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166108fc839081150290604051600060405180830381858888f19350505050158015610564573d6000803e3d6000fd5b5060008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166108fc829081150290604051600060405180830381858888f193505050501580156105cb573d6000803e3d6000fd5b505050565b600460009054906101000a900460ff1681565b60008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614610671576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161066890610c80565b60405180910390fd5b60016003811115610685576106846107e6565b5b600460009054906101000a900460ff1660038111156106a7576106a66107e6565b5b146106e7576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016106de90610d12565b60405180910390fd5b80600260006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506002600460006101000a81548160ff0219169083600381111561074e5761074d6107e6565b5b021790555050565b6000819050919050565b61076981610756565b82525050565b60006020820190506107846000830184610760565b92915050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b60006107b58261078a565b9050919050565b6107c5816107aa565b82525050565b60006020820190506107e060008301846107bc565b92915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602160045260246000fd5b60048110610826576108256107e6565b5b50565b600081905061083782610815565b919050565b600061084782610829565b9050919050565b6108578161083c565b82525050565b6000602082019050610872600083018461084e565b92915050565b600080fd5b610886816107aa565b811461089157600080fd5b50565b6000813590506108a38161087d565b92915050565b6000602082840312156108bf576108be610878565b5b60006108cd84828501610894565b91505092915050565b600082825260208201905092915050565b7f43616c6c6572206f6620746869732066756e6374696f6e206d7573742062652060008201527f62757965722e0000000000000000000000000000000000000000000000000000602082015250565b60006109436026836108d6565b915061094e826108e7565b604082019050919050565b6000602082019050818103600083015261097281610936565b9050919050565b7f4f72646572206d75737420756e7061696420746f20626520706169642e000000600082015250565b60006109af601d836108d6565b91506109ba82610979565b602082019050919050565b600060208201905081810360008301526109de816109a2565b9050919050565b7f506179656d656e742076616c7565206d61737420657175616c20746f2074686560008201527f20636f73742e0000000000000000000000000000000000000000000000000000602082015250565b6000610a416026836108d6565b9150610a4c826109e5565b604082019050919050565b60006020820190508181036000830152610a7081610a34565b9050919050565b7f4f72646572206d757374206265207069636b656420757020746f20626520646560008201527f6c6976657265642e000000000000000000000000000000000000000000000000602082015250565b6000610ad36028836108d6565b9150610ade82610a77565b604082019050919050565b60006020820190508181036000830152610b0281610ac6565b9050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b6000610b4382610756565b9150610b4e83610756565b9250828202610b5c81610756565b91508282048414831517610b7357610b72610b09565b5b5092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601260045260246000fd5b6000610bb482610756565b9150610bbf83610756565b925082610bcf57610bce610b7a565b5b828204905092915050565b6000610be582610756565b9150610bf083610756565b9250828203905081811115610c0857610c07610b09565b5b92915050565b7f43616c6c6572206f6620746869732066756e6374696f6e206d7573742062652060008201527f6f776e65722e0000000000000000000000000000000000000000000000000000602082015250565b6000610c6a6026836108d6565b9150610c7582610c0e565b604082019050919050565b60006020820190508181036000830152610c9981610c5d565b9050919050565b7f4f72646572206d7573742062652070616964206265666f7265206265696e672060008201527f7069636b65642075702e00000000000000000000000000000000000000000000602082015250565b6000610cfc602a836108d6565b9150610d0782610ca0565b604082019050919050565b60006020820190508181036000830152610d2b81610cef565b905091905056fea2646970667358221220c21969f9cc7638148f7d535fc9e947971c10385b1bdde02009e0c7b7ebca3a8e64736f6c63430008120033"