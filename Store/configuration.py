from datetime import timedelta
from os import environ

class Configuration:
    #127.0.0.1
    #CHECK ENVIRONMENT VARIABLES
    if "DOCKER_INSTANCE" in environ:
        DATABASE_URL = "database"
    else:
        DATABASE_URL = "127.0.0.1"
    if "SPARK_INSTANCE" in environ:
        SPARK_URL = "spark-master"
    else:
        SPARK_URL = "127.0.0.1"

    SQLALCHEMY_DATABASE_URI   = f"mysql://root:root@{DATABASE_URL}:33066/store"
    SPARK_MASTER_URI          = f"spark://{SPARK_URL}:7077"
    JWT_SECRET_KEY            = "JWT_SECRET_DEV_KEY"
    OWNER_PRIVATE_KEY         = "0xb64be88dd6b89facf295f4fd0dda082efcbe95a2bb4478f5ee582b7efe88cf60"
    CONTRACT_ABI              = [
                                    {
                                        "inputs": [
                                            {
                                                "internalType": "address",
                                                "name": "_buyer",
                                                "type": "address"
                                            },
                                            {
                                                "internalType": "uint256",
                                                "name": "_cost",
                                                "type": "uint256"
                                            }
                                        ],
                                        "stateMutability": "nonpayable",
                                        "type": "constructor"
                                    },
                                    {
                                        "inputs": [],
                                        "name": "buyer",
                                        "outputs": [
                                            {
                                                "internalType": "address",
                                                "name": "",
                                                "type": "address"
                                            }
                                        ],
                                        "stateMutability": "view",
                                        "type": "function"
                                    },
                                    {
                                        "inputs": [],
                                        "name": "cost",
                                        "outputs": [
                                            {
                                                "internalType": "uint256",
                                                "name": "",
                                                "type": "uint256"
                                            }
                                        ],
                                        "stateMutability": "view",
                                        "type": "function"
                                    },
                                    {
                                        "inputs": [],
                                        "name": "courier",
                                        "outputs": [
                                            {
                                                "internalType": "address",
                                                "name": "",
                                                "type": "address"
                                            }
                                        ],
                                        "stateMutability": "view",
                                        "type": "function"
                                    },
                                    {
                                        "inputs": [],
                                        "name": "delivered",
                                        "outputs": [],
                                        "stateMutability": "nonpayable",
                                        "type": "function"
                                    },
                                    {
                                        "inputs": [],
                                        "name": "owner",
                                        "outputs": [
                                            {
                                                "internalType": "address",
                                                "name": "",
                                                "type": "address"
                                            }
                                        ],
                                        "stateMutability": "view",
                                        "type": "function"
                                    },
                                    {
                                        "inputs": [],
                                        "name": "pay",
                                        "outputs": [],
                                        "stateMutability": "payable",
                                        "type": "function"
                                    },
                                    {
                                        "inputs": [],
                                        "name": "pickUpPackage",
                                        "outputs": [],
                                        "stateMutability": "nonpayable",
                                        "type": "function"
                                    },
                                    {
                                        "inputs": [],
                                        "name": "state",
                                        "outputs": [
                                            {
                                                "internalType": "enum Order.State",
                                                "name": "",
                                                "type": "uint8"
                                            }
                                        ],
                                        "stateMutability": "view",
                                        "type": "function"
                                    }
                                ]
    CONTRACT_BYTECODE        = "60806040523480156200001157600080fd5b5060405162000df738038062000df783398181016040528101906200003791906200019a565b336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555081600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550806003819055506000600460006101000a81548160ff02191690836003811115620000e857620000e7620001e1565b5b0217905550505062000210565b600080fd5b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b60006200012782620000fa565b9050919050565b62000139816200011a565b81146200014557600080fd5b50565b60008151905062000159816200012e565b92915050565b6000819050919050565b62000174816200015f565b81146200018057600080fd5b50565b600081519050620001948162000169565b92915050565b60008060408385031215620001b457620001b3620000f5565b5b6000620001c48582860162000148565b9250506020620001d78582860162000183565b9150509250929050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602160045260246000fd5b610bd780620002206000396000f3fe60806040526004361061007b5760003560e01c80637150d8ae1161004e5780637150d8ae146100f75780638da5cb5b14610122578063bbdfbfba1461014d578063c19d93fb146101645761007b565b806313faede6146100805780631b9265b8146100ab57806334791416146100b557806350a7f7d3146100cc575b600080fd5b34801561008c57600080fd5b5061009561018f565b6040516100a291906106ce565b60405180910390f35b6100b3610195565b005b3480156100c157600080fd5b506100ca61030c565b005b3480156100d857600080fd5b506100e16103f0565b6040516100ee919061072a565b60405180910390f35b34801561010357600080fd5b5061010c610416565b604051610119919061072a565b60405180910390f35b34801561012e57600080fd5b5061013761043c565b604051610144919061072a565b60405180910390f35b34801561015957600080fd5b50610162610460565b005b34801561017057600080fd5b506101796106a2565b60405161018691906107bc565b60405180910390f35b60035481565b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614610225576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161021c9061085a565b60405180910390fd5b6000600381111561023957610238610745565b5b600460009054906101000a900460ff16600381111561025b5761025a610745565b5b1461029b576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610292906108c6565b60405180910390fd5b60035434146102df576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016102d690610958565b60405180910390fd5b6001600460006101000a81548160ff0219169083600381111561030557610304610745565b5b0217905550565b600160038111156103205761031f610745565b5b600460009054906101000a900460ff16600381111561034257610341610745565b5b14610382576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610379906109ea565b60405180910390fd5b33600260006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506002600460006101000a81548160ff021916908360038111156103e9576103e8610745565b5b0217905550565b600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b60008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16146104f0576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016104e79061085a565b60405180910390fd5b6002600381111561050457610503610745565b5b600460009054906101000a900460ff16600381111561052657610525610745565b5b14610566576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161055d90610a7c565b60405180910390fd5b60038081111561057957610578610745565b5b600460009054906101000a900460ff16600381111561059b5761059a610745565b5b50506000600560016003546105b09190610acb565b6105ba9190610b3c565b90506000816003546105cc9190610b6d565b9050600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166108fc839081150290604051600060405180830381858888f19350505050158015610636573d6000803e3d6000fd5b5060008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166108fc829081150290604051600060405180830381858888f1935050505015801561069d573d6000803e3d6000fd5b505050565b600460009054906101000a900460ff1681565b6000819050919050565b6106c8816106b5565b82525050565b60006020820190506106e360008301846106bf565b92915050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000610714826106e9565b9050919050565b61072481610709565b82525050565b600060208201905061073f600083018461071b565b92915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602160045260246000fd5b6004811061078557610784610745565b5b50565b600081905061079682610774565b919050565b60006107a682610788565b9050919050565b6107b68161079b565b82525050565b60006020820190506107d160008301846107ad565b92915050565b600082825260208201905092915050565b7f43616c6c6572206f6620746869732066756e6374696f6e206d7573742062652060008201527f62757965722e0000000000000000000000000000000000000000000000000000602082015250565b60006108446026836107d7565b915061084f826107e8565b604082019050919050565b6000602082019050818103600083015261087381610837565b9050919050565b7f4f72646572206d75737420756e7061696420746f20626520706169642e000000600082015250565b60006108b0601d836107d7565b91506108bb8261087a565b602082019050919050565b600060208201905081810360008301526108df816108a3565b9050919050565b7f506179656d656e742076616c7565206d61737420657175616c20746f2074686560008201527f20636f73742e0000000000000000000000000000000000000000000000000000602082015250565b60006109426026836107d7565b915061094d826108e6565b604082019050919050565b6000602082019050818103600083015261097181610935565b9050919050565b7f4f72646572206d7573742062652070616964206265666f7265206265696e672060008201527f7069636b65642075702e00000000000000000000000000000000000000000000602082015250565b60006109d4602a836107d7565b91506109df82610978565b604082019050919050565b60006020820190508181036000830152610a03816109c7565b9050919050565b7f4f72646572206d757374206265207069636b656420757020746f20626520646560008201527f6c6976657265642e000000000000000000000000000000000000000000000000602082015250565b6000610a666028836107d7565b9150610a7182610a0a565b604082019050919050565b60006020820190508181036000830152610a9581610a59565b9050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b6000610ad6826106b5565b9150610ae1836106b5565b9250828202610aef816106b5565b91508282048414831517610b0657610b05610a9c565b5b5092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601260045260246000fd5b6000610b47826106b5565b9150610b52836106b5565b925082610b6257610b61610b0d565b5b828204905092915050565b6000610b78826106b5565b9150610b83836106b5565b9250828203905081811115610b9b57610b9a610a9c565b5b9291505056fea2646970667358221220ae3c4c27173af5583d5ade9d54dc28ed4d9fe1571306373c2f08b62ad224083a64736f6c63430008120033"